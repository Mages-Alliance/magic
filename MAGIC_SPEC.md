# Magic: A System Specification

**Version:** 1.0
**Status:** Active

## 1. Core Philosophy: The Wizard and the Spirit

Magic is not a monolithic application but a framework for the modern **Wizard** (the user) to enact their will. The Wizard summons a supportive **Spirit** (the AI agent) and gives it power by casting **Spells** (prompts).

The Wizard's power comes from their knowledge of the spells and how to chain them together. The Spirit's role is to be a faithful medium, receiving the spells and presenting the results of the magic.

The standard ritual follows three phases:
1.  **The Summoning (Bootstrap):** The Wizard casts a sequence of spells to bring the Spirit into a state of readiness.
2.  **Working Magic (Operation):** The Wizard interacts with the Spirit, directing it to perform tasks.
3.  **Chronicling (Consolidation):** The Wizard casts a final spell to have the Spirit record a summary of the session.

## 2. Architecture: The Wizard's Scrolls

The Magic framework is application-agnostic. Its true power lies in the **Scrolls** (extensions) that the Wizard studies. Each Scroll adds new spells to the Wizard's Spellbook, granting the Spirit new capabilities.

### Extension Design Principles

All extensions (Scrolls) MUST adhere to the following architectural rules:

*   **Data Separation:** Extensions are stateless. The Spirit operates on data stored in the root `data/` directory, which belongs to the Wizard.
*   **Self-Containment:** An extension must clearly document the data format it requires in its own `README.md`. All artifacts it generates must be saved to a sub-directory within the extension's own folder.
*   **Single Layer:** Extensions should extend the core system, but not other extensions.
*   **Git-Managed:** Each extension should be a self-contained unit, ideally managed as its own Git repository.

## 3. Core Components

*   **`system/` directory:** Contains the foundational spells for the framework and the Spellbook.
    *   `00-registry.md`: The central **Spellbook** (Bootstrap Registry).
*   **`scrolls/` directory:** The home for all Scrolls (application-level prompt bundles).
*   **`data/` directory:** The designated location for all the Wizard's data.
*   **`MAGIC_SPEC.md` (This document):** The canonical source of truth for the system's design.
*   **`README.md`:** The Wizard's "Getting Started" guide.

## 4. Agent Behavior: A System of Layered Rules

The Spirit's behavior is composed of layered rule sets. Its base behavior is governed by the Wizard's global preferences (the "user rules"). The Scrolls it is given provide temporary, topic-relevant rule sets on top of that base. The Spirit will always announce which rules it is operating under at the start of a session.

## 5. Architectural Traceability

This section maps the core design principles to their direct implementation in the project's structure.

| Principle | Implementation |
|---|---|
| **The Wizard and the Spirit** | The bootstrap sequences defined in `system/00-registry.md` (`The Spellbook`), which serially load the Spirit's state. |
| **Session Consolidation** | The `system/memory/` directory, which is the target for the session summary generated by the "goodbye" spell. |
| **Extension Architecture (Scrolls)** | The `scrolls/` directory, which houses all modular application logic. |
| **Data Separation** | The root `data/` directory, which is explicitly separated from the `scrolls/` and `system/` logic. |
| **Self-Containment** | The `scrolls/qualified_self/reports/` directory and the `scrolls/qualified_self/README.md` file are examples. |
| **Layered Rule System** | The bootstrap sequence in `The Spellbook`, which loads extension-specific rules and instructs the Spirit to announce them. |
